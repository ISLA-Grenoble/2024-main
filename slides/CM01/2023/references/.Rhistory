_HiStOrY_V2_
q()
load(mtcars)
load(mtcars.data)
knitr::opts_chunk$set(echo = TRUE)
life <- c(18.73, 14.52, 17.43, 14.54, 13.44,
24.39, 13.34, 22.71, 12.68, 19.32,
30.16, 27.09, 25.40, 26.05, 33.49,
35.62, 26.07, 36.78, 34.95, 43.67)
rpm <- c(610, 950, 720, 840, 980, 530 ,680 ,540, 890, 730,
670, 770, 880, 1000, 760, 590, 910, 650, 810, 500)
brand <- c('A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A',
'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B')
brand <- factor(brand)
df <- data.frame(life, rpm, brand)
head(df)
mylm <- lm(life ~ rpm + brand, data=df)
summary(mylm)
contrasts(df$brand)
set.seed(1)
X <- seq(-5, 5, length=100)
Y <- X - X^2 + X^3 + rnorm(100, mean=0, sd=20)
df <- data.frame(X, Y)
mylm_3 <- lm(Y ~ poly(X, degree=3, raw=TRUE), data=df)
mylm_20 <- lm(Y ~ poly(X, degree=20, raw=TRUE), data=df)
plot(X, Y, xlab = 'X', ylab = 'Y')
Yfit_3 = predict(mylm_3, data.frame(X))
lines(X, Yfit_3, col=1, lwd=2)
Yfit_20 = predict(mylm_20, data.frame(X))
lines(X, Yfit_20, col=2, lwd=2)
legend("topleft",col=1:2,legend=c("degree=3","degree=20"),lwd=c(2,2,2))
set.seed(1)
X <- seq(-5, 5, length=100)
Y <- X - X^2 + X^3 + rnorm(100, mean=0, sd=20)
maxDegree = 20
training_eror <- c(1:maxDegree)
for (i in 1:maxDegree)
{
fmi <- lm(Y ~ poly(X, degree=i, raw=TRUE))
training_eror[i] <- mean(fmi$residuals^2)
}
cross_val <- function(yy, xx, degree)
{
res <- vector(mode="numeric",length=10)
for (i in 1:10)
{
idx_test <- i + seq(0, 90, by=10)
x_train <- xx[-idx_test]; x_test <- xx[idx_test]
y_train <- yy[-idx_test]; y_test <- yy[idx_test]
w <- x_train; z <- y_train
f <- lm(z ~ poly(w, degree=degree, raw=TRUE))
error <- predict(object=f, newdata=data.frame(w=x_test)) - y_test
res[i] <- mean( error^2 )
}
return (c(mean(res)))
}
test_error <- vector(mode="numeric",length=maxDegree)
for (j in 1:maxDegree)
{
test_error[j] <- cross_val(Y, X, j)
}
plot(c(1:maxDegree), training_eror, col=1, xlab='polynomial degree', ylab='error')
points(c(1:maxDegree), test_error, col=2)
legend("topright",col=1:2,legend=c("training error","testing error"),lwd=c(2,2,2))
df <- mtcars[,c(1:5)]
df
life <- c(18.73, 14.52, 17.43, 14.54, 13.44,
24.39, 13.34, 22.71, 12.68, 19.32,
30.16, 27.09, 25.40, 26.05, 33.49,
35.62, 26.07, 36.78, 34.95, 43.67)
rpm <- c(610, 950, 720, 840, 980, 530 ,680 ,540, 890, 730,
670, 770, 880, 1000, 760, 590, 910, 650, 810, 500)
brand <- c('A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A',
'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B')
brand <- factor(brand)
df <- data.frame(life, rpm, brand)
head(df)
df
setwd("~/Courses/ENSIMAG/SADM/Week 01/CM")
Advertising <- read.csv('./Advertising.csv', header=TRUE)[, 2:5]
Advertising
?lm
col(Advertising)
colnames(Advertising)
mylm <- lm(sales ~ .)
mylm <- lm(sales ~ ., data=Advertising)
summary(mylm)
summary(Advertising)
mylm1 <- lm(sales ~ newspaper, data=Advertising)
colnames()
colnames(Advertising)
mylm1 <- lm(sales ~ newspaper, data=Advertising)
mylm2 <- lm(sales ~ ., data=Advertising[c(3, 4)])
Advertising[c(3, 4)]
Advertising[3:4]
Advertising[c(1, 3, 4)]
cor(Advertising)
life <- c(18.73, 14.52, 17.43, 14.54, 13.44,
24.39, 13.34, 22.71, 12.68, 19.32,
30.16, 27.09, 25.40, 26.05, 33.49,
35.62, 26.07, 36.78, 34.95, 43.67)
rpm <- c(610, 950, 720, 840, 980, 530 ,680 ,540, 890, 730,
670, 770, 880, 1000, 760, 590, 910, 650, 810, 500)
brand <- c('A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A', 'A',
'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B', 'B')
brand <- factor(brand)
df <- data.frame(life, rpm, brand)
head(df)
df
head(df)
set.seed(1)
X <- seq(-5, 5, length=100)
Y <- X - X^2 + X^3 + rnorm(100, mean=0, sd=20)
df <- data.frame(X, Y)
df
plot(X, Y, xlab = 'X', ylab = 'Y')
?plot
mylm_3 <- lm(Y ~ poly(X, degree=3, raw=TRUE), data=df)
mylm_100 <- lm(Y ~ poly(X, degree=100, raw=TRUE), data=df)
plot(X, Y, xlab = 'X', ylab = 'Y')
Yfit_3 = predict(mylm_3, data.frame(X))
lines(X, Yfit_3, col=1, lwd=2)
legend("topleft",col=1,legend=c("degree=3"),lwd=c(2,2,2))
plot(X, Y, xlab = 'X', ylab = 'Y')
Yfit_100 = predict(mylm_100, data.frame(X))
lines(X, Yfit_3, col=1, lwd=2)
lines(X, Yfit_100, col=2, lwd=2)
legend("topleft",col=1:2,legend=c("degree=3","degree=100"),lwd=c(2,2,2))
mtcars
iris
